\documentclass[expanded]{lkx_pset}

\title{Math 213b Problem Set 8}
\author{Lev Kruglyak}
\due{April 3, 2024}

\input{../math213b.sty}

\collaborator{AJ LaMotta}
\collaborator{Jarell Cheong}

\begin{document}
\maketitle

\begin{problem}{1}
Let $X$ be a compact, connected Riemann surface of genus $g\ge1$, and
let
$p\in X$. Recall the notation
\[
	l(D) = \dim \mathcal{L}(D),
\]
and write $l_{k} = l(k\cdot p)$.
\end{problem}

\begin{solution}
	Briefly explain the following (because we've seen this sort of thing
	before):
	\begin{part}{a}
		$l_{0} = 1$,
	\end{part}

	Since the global holomorphic functions on a compact connected Riemann surface are constant functions, it follows that $\mathcal{L}(0)\cong \C$ and so $\ell_0 = \ell(0)=1$.

	\begin{part}{b}
		$l_{2g-1} = g$,
	\end{part}

	This is a special case of (c) for $k=2g-1$.

	\begin{part}{c}
		$l_{k} = k-g+1$ for $k\ge 2g-1$ (generalizing the
		previous),
	\end{part}

	For any canonical divisor $K$ (recall that it must have $\deg = 2g-2$ and $D=k\cdot p$, note that
	\[
		\deg(K-D) = \deg(K) -  \deg(D) = (2g-2) - k \leq (2g-2) - (2g-1) < 0
	\]
	so $\ell(K-D)=0$. Applying the Riemann-Roch theorem, we can see that
	\[
		\ell_k = \ell(D) = \ell(D) - \ell(K-D) = \deg(D)-g+1 = k-g+1.
	\]

	\begin{part}{d}
		$l_{k} \in \{ l_{k-1}, l_{k-1}+1 \}$ for all $k$.
	\end{part}

	Since $\ell(D+p)\in \{ \ell(D), \ell(D)+1\}$ for any divisor $D$, if we set $D= (k-1)p$ we get the desired result that
	\[\ell_k=\ell(k\cdot p)= \ell((k-1)\cdot p + p) \in \{ \ell_{k-1}, \ell_{k-1}+1\}.\]

	\begin{part}{}
		Consider now the subset $E$ of the natural numbers $\mathbb{N}=\{ 1, 2,
			\dots \}$ defined by
		\[
			E = \{ \, k\in \mathbb{N} \mid l_{k} > l_{k-1} \, \}.
		\]
		Observe that $k \in E$ means that there exists a meromorphic function
		$f \in \mathcal{L}(k \cdot p)$ with a pole of order \emph{exactly} $k$ at
		$p$. Define $G=G(X,p)$ to be the complement of $E$:
		\[
			G(X,p) = \{ \, k \in \mathbb{N} \mid l_{k}=l_{k-1} \, \}.
		\]
		The letter $G$ (my choice) stands for ``gap'', and the set $G(X,p)$ is
		called the \emph{gap sequence}. It is the set of $k$ such that there
		does \emph{not} exist $f\in \mathcal{L}(k\cdot p)$ with a pole of order
		exactly $k$ at $p$.
	\end{part}

	\begin{part}{e}
		Show that $k$ belongs to the gap sequence $G$ if and only if there
		exists a holomorphic differential whose order at $p$ is exactly $k-1$.
	\end{part}

	As in the previous part, we know that $\dim \Omega(-D-p) \in \{ \dim \Omega(-p)-1, \dim \Omega(-D)\}$ for any $D$. More specifically, we have
	\[
		\dim \Omega(-D -p) = \begin{cases}
			\dim \Omega(-D) - 1 & \exists \alpha\in \Omega(-D)\quad\textrm{such that}\quad \ord_p(\alpha)=k-1, \\
			\dim\Omega(-D)      & \textrm{otherwise}.
		\end{cases}
	\]
	Next, note that applying the Riemann-Roch theorem to both $D+p$ and $D$ gives us
	\[
		\begin{aligned}
			k-g+1 & = \ell(D+p) - \dim \Omega(-D - p), \\
			k-g   & = \ell(D) - \dim \Omega(-D),
		\end{aligned}
	\]
	which in particular means that $\dim \Omega(-D-p) \neq \dim\Omega(-D)$. Thus, $\ell_k=\ell_{k-1}$ if and only if there is some $\alpha \in \Omega(-D)$ with $\ord_p(\alpha)=k-1$. By the definition of a gap sequence, it follows that $k$ is in $G$ if and only if there is such an $\alpha$.

	\begin{part}{f}
		Using the observations above, show that $G$ contains
		exactly $g$ elements and $G\subset\{ 1, 2, \dots, 2g\}$.
	\end{part}

	Suppose that $k\geq 2g$. Then since $k-1\geq 2g-1$, by Part c, it follows that
	\[
		\begin{aligned}
			\ell_k = k-g+1\quad\textrm{and}\quad \ell_{k-1}=k-1-g+1.
		\end{aligned}
	\]
	This means that $\ell_k = \ell_{k-1}+1$ so $k\not\in G$ and we get $G\subset \subset \{1,\ldots, 2g\}$.

	Now from Part d, it follows that
	\[
		E\cap \{1,\ldots, 2g-1\} = \{k\in\{1,\ldots,2g-1\} : \ell_k = \ell_{k-1}+1\}.
	\]
	Since $\ell_{2g-1}=\ell_0 + (g-1)$ by the first two parts, the right hand side has size $g-1$. This means that \[|G| = |G\cap \{1,\ldots, 2g-1\}=|\{1,\ldots, 2g-1\}| - |E\cap \{1,\ldots, 2g-1\}| = (2g-1)-(g-1)=g.\]

	\begin{part}{g}
		Show that $p$ is a Weierstrass point if and only if $G$ is \emph{not}
		the sequence $\{1,2,\dots, g\}$.
	\end{part}

	A Weierstrass point is some $p$ such that $\dim \Omega(-g\cdot p)\geq 1$, or equivalently if there is a holomorphic differential $\alpha$ satisfying $\ord_p(\alpha)\geq g$. This is in turn equivalent to the existence of some $k\geq g+1$ such that $k\in G$, which is equivalent to $G\neq \{1,\ldots, g\}$ since $|G|=g$.
\end{solution}

\begin{problem}{2}
Let $X$ be a hyperelliptic Riemann surface and $p\in X$ a branch  point of
the double-covering of $\CP^{1}$.
Show that \[G(X,p) = \{1,3, \dots, 2g-1\}.\]

% \emph{Hint.} Work with the meromorphic functions and their poles, not
% with the holomorphic differentials and their zeros.
\end{problem}

\begin{solution}
	Let's say $\varphi : X \to \CP^1$ is a double cover as in the problem statement.
	Consider the function $f_1 : X \to \CP^1$ given by $h\circ \varphi$, where $h$ is a M\"obius transformation sending $\varphi(p)\to \infty$. Clearly $\ord_p(f_1)=-2$, and letting $f_k = f_1^k$ we get a family of functions with $\ord_p(f_k)=-2k$.
	By the definition of the gap sequence, it follows that $G(X,p)$ does not contain any even numbers $2,4,\ldots, 2g$. Yet $G(X,p)\subset \{1,\ldots, 2g\}$ and $|G(X,p)|=g$, so in fact $G(X,p)$ is exactly $\{1,3,\ldots, 2g-1\}$.
\end{solution}

\begin{problem}{3}
Let $k_{1}, \dots k_{g}$ be distinct non-negative integers.
\end{problem}

\begin{parts}
	\begin{part}{a}
		Compute the Wronskian of the functions $z^{k_{1}}, \dots
			z^{k_{g}}$, up to a constant multiplicative factor. \emph{Either}
		compute the numerical factor explicitly (scary) \emph{or} show it
		must be non-zero.
	\end{part}

	Entrywise, the Wroknski matrix is given entrywise by
	\[
		A(z^{k_1},\ldots, z^{k_g})_{i,j} = \frac{\partial^{i-1}z^{k_j}}{dz^{i-1}}=\frac{k_j!}{(k_j-i+1)!}z^{k_j-i+1}.
	\]
	This means that $A(z^{k_1},\ldots, z^{k_g})_{i,j} = z^{k_j - i +1} A(z^{k_1},\ldots, z^{k_g})(1)_{i,j}$ so the Wronskian can be expressed as
	\[
		\begin{aligned}
			W(z^{k_1},\ldots, z^{k_g}) &
			= \sum_{\sigma \in S_g}\textrm{sign}(\sigma)\prod^g_{i=1} A(z^{k_1},\ldots, z^{k_g})_{i, \sigma(i)} \\
			                           & = z^{D} \textrm{det}\,A(z^{k_1},\ldots, z^{k_g})(1).
		\end{aligned}
	\]
	This means that the multiplicative factor is the determinant of the Wronski matrix, which is non-zero by a standard matrix determinant formula in combinatorics.

	\begin{part}{b}
		Let $p\in X$ now be a Weierstrass point on a Riemann surface of
		genus $g$, and let $\{k_{1}, \dots, k_{g}\}$ be the gap sequence
		$G(X,p)$. Using the definition of the multiplicity of a
		Weierstrass point in terms of the order of vanishing of the
		Wronskian, express the multiplicity of the Weierstrass point $p$
		in terms of the gaps $k_{i}$.
	\end{part}

	We know from Problem 1 that there is some $\omega_i\in H^{1,0}(X)$ satisfying $\ord_p(\omega_i)=k_i-1$ for all $1\leq i\leq g$. We can thus get a local coordinate $z$ of $X$ near $p$ such that
	\[\omega_i = f_i dz = z^{k_i-1} + O(z^{k_i})\, dz\]
	Moreover, these $f_i$ are linearly independent over $\C$. These forms form a basis for $H^{1,0}(X)$ by the main theorem.

	Now to get the multiplicity of the Weierstrass point $p$, note that the Wronski matrix has the form
	\[
		A(f_1,\ldots, f_g)_{i,j} = \frac{\partial^{i-1} f_j}{dz^{i-1}} = A(z^{k_1-1},\ldots, z^{k_g-1})_{i,j} + O(z^{k_j-i+1}),
	\]
	and the Wronskian has the form
	\[
		W(f_1,\ldots, f_g) = z^{\sum_{i=1}^g k_i-i}\left(\textrm{det}\, A(z^{k_1-1}, \ldots, z^{k_g-1})(1) + O(z)\right).
	\]
	Since this scaling factor is nonzero, it follows that
	\[
		\ord_p W(f_1,\ldots, f_g) = \sum^g_{i=1}k_i - \frac{g(g+1)}{2}.
	\]

	\begin{part}{c}
		Let $X$ be a hyperelliptic curve of genus $g$. How many
		Weierstrass points are there on $X$, and what are their
		multiplicities?
	\end{part}

	The Riemann-Hurwitz formula applied to the double covering $\varphi$ gives us $2g+2$ branch points, so let's label them $p_1,\ldots, p_{2g+2}$. Using Problem 2, we know that
	\[
		G(X, p_i) = \{ 1, 3,\ldots, 2g-1\}
	\]
	so all of the $p_i$ are Weierstrass points by Problem 1. By the previous problem, the order of the Wronskian is
	\[
		\ord_{p_i} W(f_1,\ldots, f_g) = \sum^g_{k=1}(2k-1) - \frac{g(g+1)}{2} = \frac{g(g-1)}{2}.
	\]
	This means that the number of Weierstrass points which are also branch points of $\varphi$, counted with multiplicity, is
	\[
		\sum_{i=1}^{2g+2}\ord_{p_i} W(f_1,\ldots, f_g) = (2g+2)\frac{g(g-1)}{2} = g(g^2-1).
	\]
	The total number of Weierstrass points however, is $g(g^2-1)$. This means that the branch points are all of the Weierstrass points. So there are $2g+2$ Weierstrass points on $X$, namely the branch points of the double-covering $\varphi$ and each point has multiplicity $g(g-1)/2$.
\end{parts}

\end{document}
